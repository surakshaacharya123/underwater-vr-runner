<!DOCTYPE html>
<html>
<head>
    <title>Underwater Starfish Runner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { margin: 0; overflow: hidden; background: #001122; font-family: Arial; }
        #ui { position: absolute; top: 10px; left: 10px; color: white; background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px; z-index: 100; }
        #controls { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; z-index: 100; }
        .btn { padding: 12px 20px; background: #ff6b35; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; }
        .btn:hover { background: #ff8c5a; }
        #instructions { position: absolute; bottom: 20px; left: 20px; color: white; background: rgba(0,0,0,0.7); padding: 10px; border-radius: 5px; z-index: 100; }
        #gameOver {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9); color: white; padding: 40px; border-radius: 20px;
            text-align: center; display: none; z-index: 200; border: 3px solid #ff6b35;
        }
    </style>
</head>
<body>
    <div id="ui">
        <h3>üê† Underwater Starfish Runner</h3>
        <div>üí∞ Coins: <span id="coins">0</span></div>
        <div>üìè Distance: <span id="distance">0</span>m</div>
        <div>‚ö° Speed: <span id="speed">15</span> m/s</div>
    </div>
    
    <div id="instructions">
        <div>üê† Use ‚Üê ‚Üí ‚Üë to swim and avoid obstacles!</div>
        <div>üí∞ Collect coins to increase speed</div>
        <div>üí• Hit obstacles to break them and end game</div>
    </div>
    
    <div id="controls">
        <button class="btn" id="leftBtn">‚Üê</button>
        <button class="btn" id="upBtn">‚Üë</button>
        <button class="btn" id="rightBtn">‚Üí</button>
    </div>
    
    <div id="gameOver">
        <h1>üèÜ GAME OVER!</h1>
        <div id="finalStats"></div>
        <button class="btn" onclick="location.reload()">Play Again</button>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
    <script>
        // Scene setup
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x001122);
        scene.fog = new THREE.Fog(0x003366, 15, 60);
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 3, 5);
        
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        document.body.appendChild(renderer.domElement);
        
        // Underwater lighting
        const ambientLight = new THREE.AmbientLight(0x336699, 0.6);
        scene.add(ambientLight);
        
        const sunlight = new THREE.DirectionalLight(0x66AAFF, 1.5);
        sunlight.position.set(0, 30, 10);
        sunlight.castShadow = true;
        scene.add(sunlight);
        
        // Animated sunlight rays
        const sunRays = [];
        for (let i = 0; i < 12; i++) {
            const rayGeometry = new THREE.CylinderGeometry(0.05, 1.5, 40, 8);
            const rayMaterial = new THREE.MeshBasicMaterial({ 
                color: 0x66AAFF, 
                transparent: true, 
                opacity: 0.08 
            });\n            const ray = new THREE.Mesh(rayGeometry, rayMaterial);\n            ray.position.set(\n                (Math.random() - 0.5) * 60,\n                20,\n                (Math.random() - 0.5) * 200\n            );\n            ray.rotation.x = Math.PI;\n            sunRays.push(ray);\n            scene.add(ray);\n        }\n        \n        // Ocean floor\n        const oceanFloor = new THREE.Mesh(\n            new THREE.PlaneGeometry(400, 400),\n            new THREE.MeshLambertMaterial({ color: 0x8B7355 })\n        );\n        oceanFloor.rotation.x = -Math.PI / 2;\n        oceanFloor.receiveShadow = true;\n        scene.add(oceanFloor);\n        \n        // Colorful coral reef\n        const corals = [];\n        for (let i = 0; i < 60; i++) {\n            const coralColors = [0xFF6B6B, 0xFF8E53, 0xFF6B9D, 0xC44569, 0xF8B500, 0x6C5CE7, 0xFF1744, 0x00E676];\n            const coralGeometry = new THREE.SphereGeometry(0.3 + Math.random() * 2, 8, 6);\n            const coral = new THREE.Mesh(\n                coralGeometry,\n                new THREE.MeshStandardMaterial({ \n                    color: coralColors[Math.floor(Math.random() * coralColors.length)]\n                })\n            );\n            coral.position.set(\n                (Math.random() - 0.5) * 300,\n                0.5 + Math.random() * 3,\n                (Math.random() - 0.5) * 300\n            );\n            coral.scale.y = 0.5 + Math.random() * 2;\n            corals.push(coral);\n            scene.add(coral);\n        }\n        \n        // Swaying sea plants\n        const seaPlants = [];\n        for (let i = 0; i < 80; i++) {\n            const plant = new THREE.Mesh(\n                new THREE.CylinderGeometry(0.03, 0.15, 1.5 + Math.random() * 5, 8),\n                new THREE.MeshStandardMaterial({ color: 0x228B22 })\n            );\n            plant.position.set(\n                (Math.random() - 0.5) * 350,\n                plant.geometry.parameters.height / 2,\n                (Math.random() - 0.5) * 350\n            );\n            seaPlants.push(plant);\n            scene.add(plant);\n        }\n        \n        // Swimming fish school\n        const fish = [];\n        for (let i = 0; i < 80; i++) {\n            const fishColors = [0xFF6347, 0x32CD32, 0x1E90FF, 0xFFD700, 0xFF69B4, 0x00CED1, 0xFF4500, 0x9370DB];\n            const fishBody = new THREE.Mesh(\n                new THREE.SphereGeometry(0.15 + Math.random() * 0.25, 8, 6),\n                new THREE.MeshStandardMaterial({ \n                    color: fishColors[Math.floor(Math.random() * fishColors.length)]\n                })\n            );\n            fishBody.scale.z = 2.5;\n            \n            // Fish tail\n            const tail = new THREE.Mesh(\n                new THREE.ConeGeometry(0.1, 0.25, 6),\n                fishBody.material\n            );\n            tail.position.z = -0.3;\n            tail.rotation.x = Math.PI / 2;\n            fishBody.add(tail);\n            \n            fishBody.position.set(\n                (Math.random() - 0.5) * 200,\n                1 + Math.random() * 12,\n                (Math.random() - 0.5) * 300\n            );\n            \n            fishBody.userData = {\n                speed: 0.8 + Math.random() * 2,\n                direction: Math.random() * Math.PI * 2,\n                swimHeight: fishBody.position.y\n            };\n            \n            fish.push(fishBody);\n            scene.add(fishBody);\n        }\n        \n        // Floating bubbles\n        const bubbles = [];\n        for (let i = 0; i < 150; i++) {\n            const bubble = new THREE.Mesh(\n                new THREE.SphereGeometry(0.03 + Math.random() * 0.15, 8, 6),\n                new THREE.MeshBasicMaterial({ \n                    color: 0x87CEEB, \n                    transparent: true, \n                    opacity: 0.4 \n                })\n            );\n            bubble.position.set(\n                (Math.random() - 0.5) * 300,\n                Math.random() * 20,\n                (Math.random() - 0.5) * 300\n            );\n            bubble.userData = {\n                riseSpeed: 0.3 + Math.random() * 1.2,\n                sway: Math.random() * 0.02\n            };\n            bubbles.push(bubble);\n            scene.add(bubble);\n        }\n        \n        // Race track lanes\n        for (let i = -1; i <= 1; i++) {\n            const lane = new THREE.Mesh(\n                new THREE.BoxGeometry(0.4, 0.1, 800),\n                new THREE.MeshBasicMaterial({ color: 0x66AAFF, transparent: true, opacity: 0.3 })\n            );\n            lane.position.set(i * 5, 0.2, 0);\n            scene.add(lane);\n        }\n        \n        // Realistic Starfish character\n        const starfish = new THREE.Group();\n        \n        // Central body - flattened pentagon\n        const starfishBody = new THREE.Mesh(\n            new THREE.CylinderGeometry(1.2, 1.2, 0.3, 5),\n            new THREE.MeshStandardMaterial({ \n                color: 0xFF6B35,\n                roughness: 0.8,\n                metalness: 0.1\n            })\n        );\n        starfishBody.rotation.y = Math.PI / 10;\n        starfish.add(starfishBody);\n        \n        // Starfish arms\n        const starfishLimbs = [];\n        for (let i = 0; i < 5; i++) {\n            const armGroup = new THREE.Group();\n            \n            const arm = new THREE.Mesh(\n                new THREE.ConeGeometry(0.4, 2.5, 8),\n                new THREE.MeshStandardMaterial({ \n                    color: 0xFF6B35,\n                    roughness: 0.8\n                })\n            );\n            arm.rotation.z = Math.PI / 2;\n            arm.position.x = 1.25;\n            armGroup.add(arm);\n            \n            const armTip = new THREE.Mesh(\n                new THREE.SphereGeometry(0.15, 8, 6),\n                new THREE.MeshStandardMaterial({ color: 0xFF4500 })\n            );\n            armTip.position.x = 2.4;\n            armGroup.add(armTip);\n            \n            // Texture bumps\n            for (let j = 0; j < 3; j++) {\n                const bump = new THREE.Mesh(\n                    new THREE.SphereGeometry(0.08, 6, 4),\n                    new THREE.MeshStandardMaterial({ color: 0xFF4500 })\n                );\n                bump.position.set(\n                    0.5 + j * 0.6,\n                    0.1,\n                    (Math.random() - 0.5) * 0.3\n                );\n                armGroup.add(bump);\n            }\n            \n            const angle = (i / 5) * Math.PI * 2;\n            armGroup.rotation.y = angle;\n            starfishLimbs.push(armGroup);\n            starfish.add(armGroup);\n        }\n        \n        // Central eye\n        const eyeSpot = new THREE.Mesh(\n            new THREE.SphereGeometry(0.2, 12, 8),\n            new THREE.MeshStandardMaterial({ color: 0x8B0000 })\n        );\n        eyeSpot.position.y = 0.2;\n        starfish.add(eyeSpot);\n        \n        starfish.position.set(0, 3, 0);\n        scene.add(starfish);\n        \n        // Game state\n        let gameRunning = true;\n        let starfishLane = 0;\n        let starfishY = 3;\n        let isJumping = false;\n        let distance = 0;\n        let coins = 0;\n        let speed = 18;\n        \n        // Objects and debris\n        const objects = [];\n        const debris = [];\n        \n        function createCoin(x, z) {\n            const coin = new THREE.Mesh(\n                new THREE.CylinderGeometry(0.5, 0.5, 0.2, 8),\n                new THREE.MeshBasicMaterial({ color: 0xFFD700 })\n            );\n            coin.position.set(x, 3, z);\n            coin.userData = { type: 'coin', collected: false };\n            objects.push(coin);\n            scene.add(coin);\n        }\n        \n        function createObstacle(x, z) {\n            const obstacle = new THREE.Mesh(\n                new THREE.BoxGeometry(3, 5, 2),\n                new THREE.MeshStandardMaterial({ color: 0x8B4513 })\n            );\n            obstacle.position.set(x, 2.5, z);\n            obstacle.userData = { type: 'obstacle', destroyed: false };\n            objects.push(obstacle);\n            scene.add(obstacle);\n        }\n        \n        function destroyObstacle(obstacle) {\n            if (obstacle.userData.destroyed) return;\n            obstacle.userData.destroyed = true;\n            obstacle.visible = false;\n            \n            // Create small cube debris\n            for (let i = 0; i < 25; i++) {\n                const piece = new THREE.Mesh(\n                    new THREE.BoxGeometry(0.3, 0.3, 0.3),\n                    new THREE.MeshStandardMaterial({ color: 0x8B4513 })\n                );\n                piece.position.copy(obstacle.position);\n                piece.position.add(new THREE.Vector3(\n                    (Math.random() - 0.5) * 4,\n                    (Math.random() - 0.5) * 4,\n                    (Math.random() - 0.5) * 4\n                ));\n                piece.userData = {\n                    velocity: new THREE.Vector3(\n                        (Math.random() - 0.5) * 0.5,\n                        Math.random() * 0.4 + 0.1,\n                        (Math.random() - 0.5) * 0.5\n                    )\n                };\n                debris.push(piece);\n                scene.add(piece);\n            }\n        }\n        \n        function gameOver() {\n            gameRunning = false;\n            const finalDistance = Math.floor(Math.abs(starfish.position.z));\n            const totalScore = coins * 15 + Math.floor(finalDistance / 10);\n            \n            document.getElementById('finalStats').innerHTML = `\n                <div style=\"font-size: 18px; margin: 15px 0;\">\n                    <div>üèÉ Distance Covered: <strong>${finalDistance}m</strong></div>\n                    <div>üí∞ Coins Collected: <strong>${coins}</strong></div>\n                    <div>‚ö° Final Speed: <strong>${speed.toFixed(1)} m/s</strong></div>\n                    <div>‚è±Ô∏è Time Survived: <strong>${(finalDistance / speed).toFixed(1)}s</strong></div>\n                    <div style=\"margin-top: 20px; padding: 15px; background: rgba(255,107,53,0.2); border-radius: 10px;\">\n                        üèÜ Final Score: <strong style=\"color: #FFD700; font-size: 24px;\">${totalScore} points</strong>\n                    </div>\n                </div>\n            `;\n            document.getElementById('gameOver').style.display = 'block';\n        }\n        \n        // Generate level\n        for (let z = -25; z > -600; z -= 12) {\n            for (let lane = -1; lane <= 1; lane++) {\n                if (Math.random() < 0.5) {\n                    createCoin(lane * 5, z);\n                }\n            }\n            if (Math.random() < 0.2) {\n                const obsLane = [-1, 0, 1][Math.floor(Math.random() * 3)];\n                createObstacle(obsLane * 5, z);\n            }\n        }\n        \n        // Controls\n        document.addEventListener('keydown', (e) => {\n            if (!gameRunning) return;\n            \n            if (e.code === 'ArrowLeft' && starfishLane > -1) {\n                starfishLane--;\n            }\n            if (e.code === 'ArrowRight' && starfishLane < 1) {\n                starfishLane++;\n            }\n            if (e.code === 'ArrowUp' && !isJumping) {\n                isJumping = true;\n            }\n        });\n        \n        // Touch controls\n        document.getElementById('leftBtn').onclick = () => {\n            if (gameRunning && starfishLane > -1) starfishLane--;\n        };\n        \n        document.getElementById('rightBtn').onclick = () => {\n            if (gameRunning && starfishLane < 1) starfishLane++;\n        };\n        \n        document.getElementById('upBtn').onclick = () => {\n            if (gameRunning && !isJumping) isJumping = true;\n        };\n        \n        // Animation\n        const clock = new THREE.Clock();\n        \n        function animate() {\n            const deltaTime = clock.getDelta();\n            const time = clock.getElapsedTime();\n            \n            // Animate underwater environment\n            sunRays.forEach((ray, index) => {\n                ray.material.opacity = 0.04 + Math.sin(time * 0.5 + index) * 0.02;\n                ray.rotation.z = Math.sin(time * 0.3 + index) * 0.05;\n            });\n            \n            bubbles.forEach(bubble => {\n                bubble.position.y += bubble.userData.riseSpeed * deltaTime;\n                bubble.position.x += Math.sin(time + bubble.position.z * 0.01) * bubble.userData.sway;\n                if (bubble.position.y > 25) {\n                    bubble.position.y = 0;\n                }\n            });\n            \n            fish.forEach(fishBody => {\n                fishBody.userData.direction += (Math.random() - 0.5) * 0.015;\n                fishBody.position.x += Math.cos(fishBody.userData.direction) * fishBody.userData.speed * deltaTime;\n                fishBody.position.z += Math.sin(fishBody.userData.direction) * fishBody.userData.speed * deltaTime;\n                fishBody.position.y = fishBody.userData.swimHeight + Math.sin(time * 3 + fishBody.position.x * 0.1) * 0.5;\n                fishBody.rotation.y = fishBody.userData.direction;\n            });\n            \n            seaPlants.forEach((plant, index) => {\n                plant.rotation.z = Math.sin(time * 0.8 + index * 0.3) * 0.15;\n            });\n            \n            if (gameRunning) {\n                // Move starfish forward\n                starfish.position.z -= speed * deltaTime;\n                distance += speed * deltaTime;\n                \n                // Lane switching\n                const targetX = starfishLane * 5;\n                starfish.position.x += (targetX - starfish.position.x) * 0.12;\n                \n                // Jumping\n                if (isJumping) {\n                    starfishY += 10 * deltaTime;\n                    if (starfishY > 7) {\n                        starfishY = 7;\n                        isJumping = false;\n                    }\n                } else {\n                    starfishY += (3 - starfishY) * 0.12;\n                }\n                starfish.position.y = starfishY;\n                \n                // Realistic starfish swimming animation\n                starfish.rotation.y = Math.sin(time * 2) * 0.2;\n                starfish.rotation.x = Math.sin(time * 1.5) * 0.1;\n                \n                // Arm undulation\n                starfishLimbs.forEach((limb, i) => {\n                    limb.rotation.z = Math.sin(time * 3 + i * 1.2) * 0.3;\n                    limb.children[0].rotation.y = Math.sin(time * 4 + i) * 0.2;\n                });\n                \n                // Coin animation\n                objects.forEach(obj => {\n                    if (obj.userData.type === 'coin') {\n                        obj.rotation.y += deltaTime * 3;\n                        obj.position.y = 3 + Math.sin(time * 2 + obj.position.x) * 0.3;\n                    }\n                });\n                \n                // Collision detection\n                objects.forEach(obj => {\n                    const dx = Math.abs(starfish.position.x - obj.position.x);\n                    const dy = Math.abs(starfish.position.y - obj.position.y);\n                    const dz = Math.abs(starfish.position.z - obj.position.z);\n                    \n                    if (dx < 2 && dy < 2 && dz < 3) {\n                        if (obj.userData.type === 'coin' && !obj.userData.collected) {\n                            obj.userData.collected = true;\n                            obj.visible = false;\n                            coins++;\n                            speed += 0.2;\n                        } else if (obj.userData.type === 'obstacle' && !obj.userData.destroyed) {\n                            destroyObstacle(obj);\n                            gameOver();\n                        }\n                    }\n                });\n                \n                // Camera follow\n                camera.position.z = starfish.position.z + 8;\n                camera.position.x = starfish.position.x * 0.2;\n                camera.lookAt(starfish.position.x, starfish.position.y, starfish.position.z);\n                \n                // Update UI\n                document.getElementById('coins').textContent = coins;\n                document.getElementById('distance').textContent = Math.floor(Math.abs(starfish.position.z));\n                document.getElementById('speed').textContent = speed.toFixed(1);\n            }\n            \n            // Animate debris\n            debris.forEach((piece, index) => {\n                piece.userData.velocity.y -= 0.006;\n                piece.position.add(piece.userData.velocity);\n                piece.rotation.x += 0.02;\n                piece.rotation.z += 0.015;\n                \n                if (piece.position.y < -8) {\n                    scene.remove(piece);\n                    debris.splice(index, 1);\n                }\n            });\n            \n            renderer.render(scene, camera);\n        }\n        \n        renderer.setAnimationLoop(animate);\n        \n        window.addEventListener('resize', () => {\n            camera.aspect = window.innerWidth / window.innerHeight;\n            camera.updateProjectionMatrix();\n            renderer.setSize(window.innerWidth, window.innerHeight);\n        });\n        \n        console.log('üê† Underwater Starfish Runner ready!');\n    </script>\n</body>\n</html>